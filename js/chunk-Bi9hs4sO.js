import{b as e,r as t,l as a,s,h as n,o as l,e as i,f as r,F as c,y as o,z as u}from"./chunk-Dfru-Ds3.js";import{a as m}from"./chunk-Cv_h2SVa.js";import{u as p}from"./chunk-DMoODoeY.js";const b={class:"flex gap-3"},d={for:"explore"},f=["accept"],g={class:"p-0"},v={class:"mr-12 overflow-hidden w-72 whitespace-nowrap text-ellipsis"},y={class:"flex gap-3"},k=["onClick"],h=["onClick"],C=e({__name:"MusicConfig",setup(e){const C=t(0),x=a.createInstance({name:"audioStore"}),w=p().globalConfig,{getMusicList:M}=s(w),S=t("audio/*"),j=t(M),I=()=>{w.resetMusicList(),x.clear()},L=()=>{w.clearMusicList(),x.clear()},D=async()=>{(await x.keys()).length>0&&x.iterate(((e,t)=>{w.addMusic({id:t+(new Date).getTime().toString(),name:t,url:"Storage"})}))},T=async e=>{if(!/audio*/.test(e.target.files[0].type))return void(C.value=3);let{dataUrl:t,fileName:a}=await m(e.target.files[0]);x.setItem((new Date).getTime().toString()+"+"+a,t).then((()=>{C.value=1,D()})).catch((()=>{C.value=2}))};return n((()=>{D()})),(e,t)=>(l(),i("div",null,[r("div",b,[r("button",{class:"btn btn-primary btn-sm",onClick:I},"重置音乐列表"),r("label",d,[r("input",{type:"file",class:"",id:"explore",style:{display:"none"},onChange:T,accept:S.value},null,40,f),t[0]||(t[0]=r("span",{class:"btn btn-primary btn-sm"},"上传音乐",-1))]),r("button",{class:"btn btn-error btn-sm",onClick:L},"删除所有")]),r("div",null,[r("ul",g,[(l(!0),i(c,null,o(j.value,(e=>(l(),i("li",{key:e.id,class:"flex items-center gap-6 pb-2 mb-3 divide-y"},[r("div",v,[r("span",null,u(e.name),1)]),r("div",y,[r("button",{class:"btn btn-primary btn-xs",onClick:t=>(async e=>{w.setCurrentMusic(e,!1)})(e)},"播放",8,k),r("button",{class:"btn btn-error btn-xs",onClick:t=>(e=>{w.removeMusic(e.id),x.removeItem(e.name)})(e)},"删除",8,h)])])))),128))])])]))}});export{C as default};
